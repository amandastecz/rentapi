name: CI

on:
  push:
    branches: [master]
  
  workflow_dispatch:
  
jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
        - uses: actions/checkout@v3
        
        - name: Setup Nodejs
            - uses: actions/setup-node@v3
                with:
                    node-version: 20.x
            
        - name: Install dependencies
            - run: yarn
        
        - name: Build
            - run: yarn build
        
        - name: Copy file via ssh password
            uses: appleboy/scp-action@v0.1.4
            with:
                host: ${{ secrets.SSH_HOST }}
                username: ${{ secrets.SSH_USERNAME }}
                key: ${{ secrets.SSH_KEY }}
                port: ${{ secrets.SSH_PORT }}
                source: "., !node_modules"
                target: test
